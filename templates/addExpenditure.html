<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Budget tracker 1.0</title>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!-- css -->
    <link rel="stylesheet" href="static/stylesheet/style.css">
    <!--<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='stylesheet/style.css') }}">-->

</head>

<body>
	<!-- As a heading -->
	<h2>Budget Planner</h2>

    <section>
			 <form action="/addemp" autocomplete="on" method = "POST" enctype="multipart/form-data">
				 <table>
					 <tr>
						 <td>
							<h5 >Main Category</h5>
								<select name="main_category" id= "main_category" data-target="secondList" class="firstList selectFilter" required="required">
													<option value="-1">Select</option>
													<option data-ref="Bayern">Bayern</option>
													<option data-ref="Sachsen">Sachsen</option>
													<option data-ref="Sachsen Anhalt">Sachsen Anhalt</option>
													<option data-ref="Niedersachsen">Niedersachsen</option>
													<option data-ref="Nordrhein Westfalen">Nordrhein Westfalen</option>
													<option data-ref="Berlin">Berlin</option>
													<option data-ref="Thüringen">Thüringen</option>
													<option data-ref="Hessen">Hessen</option>
													<option data-ref="Rheinland Pfalz">Rheinland Pfalz</option>
													<option data-ref="Hamburg">Hamburg</option>
													<option data-ref="Schleswig Holstein">Schleswig Holstein</option>
													<option data-ref="Brandenburg">Brandenburg</option>
													<option data-ref="Mecklenburg Vorpommern">Mecklenburg Vorpommern</option>
													<option data-ref="Baden Württemberg">Baden Württemberg</option>
													<option data-ref="Saarland">Saarland</option>
													<option data-ref="Bremen">Bremen</option>
								</select>
						 </td>
						 <td>
						<h5>Sub Category</h5>
							<select name="sub_category" id="sub_category" class="secondList selectFilter" required="required">
												<option value="-1">Select</option>
												<option data-ref="Mannheim" data-belong="Baden Württemberg" >Mannheim</option>
												<option data-ref="Lörrach Kreis" data-belong="Baden Württemberg" >Lörrach Kreis</option>
												<option data-ref="Böblingen Kreis" data-belong="Baden Württemberg" >Böblingen Kreis</option>
												<option data-ref="Stuttgart" data-belong="Baden Württemberg" >Stuttgart</option>
												<option data-ref="Heilbronn" data-belong="Baden Württemberg" >Heilbronn</option>
												<option data-ref="Rhein Neckar Kreis" data-belong="Baden Württemberg" >Rhein Neckar Kreis</option>
												<option data-ref="Esslingen Kreis" data-belong="Baden Württemberg" >Esslingen Kreis</option>
												<option data-ref="Ludwigsburg Kreis" data-belong="Baden Württemberg" >Ludwigsburg Kreis</option>
												<option data-ref="Heidelberg" data-belong="Baden Württemberg" >Heidelberg</option>
												<option data-ref="Karlsruhe Kreis" data-belong="Baden Württemberg" >Karlsruhe Kreis</option>
												<option data-ref="Heilbronn Kreis" data-belong="Baden Württemberg" >Heilbronn Kreis</option>
							</select>
							 </td>
						 <td>
						<h5>Amount</h5>
						<input type="number" name="amount" id="amount" min= "0" max="10000" required="required">
						 </td>
				 	</tr>
				 </table>
					<br>
            		<!-- Submit -->
                    <button type="submit" style="background: grey; height: 35px; width: 150px; color: white; size: 5; font:oblique;">Add Expenditure</button>
			</form>
    </section>
</body>
<script>
    $(document).ready(function () {

    let arrData = [];

  	// Fill the first dropdown with data.
    $.getJSON('../../static/stylesheet/category.json', function (data) {


        let arr_category = [];

        $.each(data, function (index, value) {
            arr_category.push(value.Type);
            arrData = data;
        });

        // Remove duplicates.
        arr_category = Array.from(new Set (arr_category));

        // ref (https://www.encodedna.com/javascript/remove-duplicates-in-javascript-array-using-es6-set-and-from.htm)

        $.each(arr_category, function (index, value) {
            // Fill the first dropdown.
            $('#main_category').append('<option value="' + value + '">' + value + '</option>');
        });

    });

    $('#main_category').change(function () {
        let type = this.options[this.selectedIndex].value;

        let filterData = arrData.filter(function(value) {
            return value.Type === type;
        });

        $('#sub_category')
            .empty()
            .append('<option value=""> -- Select -- </option>');

        $.each(filterData, function (index, value) {
            // Now, fill the second dropdown list with category names.
            $('#sub_category').append('<option value="' + value.ID + '">' + value.Name + '</option>');
        });

    });
  });
</script>
</html>